<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Receita</title>
    <link rel="stylesheet" href="assets/styling/style.css">
</head>

<body>
    <h1 id="title"></h1>

    <div class="recipe-header">
        <div>
            <div class="chip"><span class="material">room_service</span><p id="difficulty"></p></div>
            <div class="chip"><span class="material">room_service</span><p id="amount"></p></div>
            <div class="chip"><span class="material">schedule</span><p id="time"></p></div>
            <button class="chip print"><span class="material">print</span><p>Imprimir</p></button>
        </div>
        <p id="description"></p>
    </div>

    <div class="wavy-line"></div>

    <div id="ingredients">
        <h2>Ingredientes</h2>
    </div>

    <div class="wavy-line"></div>

    <div id="steps">
        <h2>Modo de preparo</h2>
    </div>

    <script>
        fetch(`./${decodeURI(top.window.location.search.substr(1))}.json`)
            .then(res => res.json())
            .then(json => {
                document.getElementById("title").innerHTML = json.title;
                document.getElementById("description").innerHTML = json.description;
                document.getElementById("amount").innerHTML = json.amount;
                document.getElementById("time").innerHTML = json.time;

                document.getElementById("difficulty").innerHTML = json.difficulty == "easy" ?
                "Fácil" : (json.difficulty == "medium" ? "Médio" : "Difícil");

                const ingredients = document.getElementById("ingredients");
                if (json.custom) {
                    //TODO
                }
                else {
                    ingredients.insertAdjacentHTML("beforeend", `<div class="section"></div>`);
                    json.ingredients.forEach(element => {
                        document.getElementsByClassName("section")[0].insertAdjacentHTML("beforeend",
                            `<label><input type="checkbox"><span>${element}</span></label>`
                        )
                    })
                }

                if (json.special != "") {
                    ingredients.insertAdjacentHTML("beforeend",
                        `<div id="special">
                                        <h3>Equipamento especial:</h3>
                                        <p>${json.special}</p>
                                    </div>`
                    )
                }

                let count = 1;
                json.steps.forEach(element => {
                    document.getElementById("steps").insertAdjacentHTML("beforeend",
                        `<div><h2>${count}.</h2><p>${element}</p></div>`
                    )
                    count += 1;
                });
            }
            );
    </script>
</body>

</html>